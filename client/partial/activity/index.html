<!-- 活动列表页面 -->
<div class="container">
  <button type="button" class="btn btn-success btn-lg" ng-click="createPage()">
    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
    新建活动
  </button>
  <form class="navbar-form navbar-right" role="search">
    <div class="form-group">
      <input type="text" class="form-control" placeholder="标题"></div>
    <button type="submit" class="btn btn-default">
      <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      搜索
    </button>
  </form>
</div>

<!-- 活动分类tab -->
<div class="container">
  <ul class="nav nav-tabs">
    <li ng-class="{active:isActive('0')}">
      <a href="#/activity/list/0">全部</a>
    </li>
    <li ng-class="{active:isActive(entity.id)}" ng-repeat="entity in activityTypeList | orderBy: 'display_order' " >
      <a href="#/activity/list/{{entity.id}}">{{entity.name}}</a>
    </li>
    <li>
      <a ng-if="!showAddForm" ng-click="onTypeAddClicked()">
        <span class="glyphicon glyphicon-plus-sign" ></span>
      </a>
      <div ng-if="showAddForm">
        <input type="text"  ng-model="addForm.newType" />
        <button class="btn-success" ng-click="commitTypeName(addForm.newType)">确认添加</button>
        <button class="btn-default" ng-click="cancelAddType()">取消</button>
      </div>
    </li>
  </ul>
</div>
<!-- 活动分类tab end -->

<!-- 活动列表 -->
<md-content md-scroll-y="" flex="" layout-padding="" class="layout-padding ng-scope flex container">
  <div class="activityList" id="activityList">
    <ul class="activityListProperty">
      <li ng-repeat="entity in list | orderBy: 'display_order' ">
        <div ng-class="{true: 'panel-default', false: 'panel-danger'}[entity.status==10]" class="panel">
          <div class="panel-heading">
            <h3 class="panel-title">
              <!-- 置顶按钮 -->
              <button type="button" class="btn btn-danger " ng-if="entity.is_top==1" ng-click="top(entity, 0)" data-toggle="button" >
                <span class="glyphicon glyphicon-circle-arrow-down" aria-hidden="true">取消置顶</span>
              </button>
              <button type="button" class="btn btn-default " ng-if="entity.is_top==0" ng-click="top(entity, 1)" data-toggle="button" >
                <span class="glyphicon glyphicon-circle-arrow-up" aria-hidden="true">置顶</span>
              </button>

              <!-- 活动标题 -->
              {{entity.id}}#
              <span ng-if="entity.status==10" >[草稿] {{entity.title}}</span>
              <span ng-if="entity.status==20" >{{entity.user.username}}</span>：
              <span ng-if="entity.status==20" >{{entity.title}}</span>
              

              <!-- 内部使用的状态标签 -->
              <div class="btn-group btn-group-xs">
                <button ng-class="{true: 'label-danger', false: 'label'}[entity.edit_status==10]" class="btn label" ng-click="onEditStatusChangeClick(entity, 10)">doing</button>
                <button ng-class="{true: 'label-warning', false: 'label'}[entity.edit_status==20]" type="button" class="btn label" ng-click="onEditStatusChangeClick(entity, 20)">pause</button>
                <button ng-class="{true: 'label-success', false: 'label'}[entity.edit_status==30]" type="button" class="btn label" ng-click="onEditStatusChangeClick(entity, 30)">done</button>
              </div>

              <span ng-if="entity.status==20">
                <!-- 查看反馈信息 -->
                <button ng-if="entity.feedback_count>0" class="btn btn-warning btn-float-right" type="button" ng-click="viewFeedback(entity)">
                  反馈
                  <span class="badge">{{entity.feedback_count}}</span>
                </button>
                <!-- 查看报名情况 -->
                <button ng-class="{true: 'btn-danger', false: 'btn-default'}[entity.question.status==10]" ng-if="entity.question" class="btn  btn-float-right" type="button" ng-click="viewAnswer(entity)">
                  <span ng-if="entity.question.status==20">报名关闭</span>
                  <span ng-if="entity.question.status==10">报名打开</span>
                  （{{entity.answer_count}}/{{entity.peoples}}）
                  <span class="badge"></span>
                </button>
              </span>
              <button ng-if="entity.status==10" class="btn btn-primary btn-float-right" ng-click="release(entity)" type="button">发布</button>
            </h3>
          </div>

          <div class="panel-body">
            <!-- 切换活动分组 -->
            <div class="btn-group">
              <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                {{entity.type.name}}
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li ng-repeat="type in activityTypeList | orderBy: 'display_order' ">
                  <a ng-click="onTypeChangeClick(entity,type.id)">{{type.name}}</a>
                </li>
              </ul>
            </div>

            <!-- 活动相关功能 -->
            <a class="btn btn-info" target="_blank" href="{{entity.preview_url}}">预览</a>
            <a class="btn btn-info" target="_blank" href="{{entity.filter_url}}">筛选</a>
            <a class="btn btn-success" href="#/activity/{{entity.id}}">编辑</a>
            <button ng-if="!entity.question" class="btn" ng-click="viewQuestion(entity)">设置表单</button>
            <button ng-if="entity.question" class="btn" ng-click="viewQuestion(entity)">修改表单</button>
            <button ng-if="entity.question" class="btn" ng-click="previewQuestion(entity)">预览表单</button>

            <!-- 下拉功能 -->
            <div class="btn-group btn-float-right">
              <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                更多
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li>
                  <a ng-click="delete(entity)">删除活动</a>
                </li>
                <li>
                  <a ng-click="copy(entity)">复制活动</a>
                </li>
                <li class="divider"></li>
                <li ng-if="entity.question.status==10">
                  <a ng-click="applyStatus(entity, 20)">关闭报名</a>
                </li>
                <li ng-if="entity.question.status==20">
                  <a ng-click="applyStatus(entity, 10)">打开报名</a>
                </li>
              </ul>
            </div>

          </div>
        </div>
      </li>
    </ul>
  </div>


  <div ng-show="modelPagination" class="someet-pagination user-pagination">
    <pagination total-items="modelPagination.totalItems" ng-model="modelPagination.currentPage" ng-change="modelPagination.pageChange()" items-per-page="modelPagination.itemsPerPage" max-size="modelPagination.maxSize" class="pagination-sm" boundary-links="false" rotate="false" >
      <a href="javascript:void(0)" ng-click="modelPagination.currentPage=1;changePage(1)">首页</a>
      <a href="javascript:void(0);" ng-click="prev()">上一页</a>
      <a href="javascript:void(0);" ng-click="changePage(page)" ng-repeat="page in pages">{{ page }}</a>
      <a href="javascript:void(0);" ng-click="next()">下一页</a>
      <a href="javascript:void(0)" ng-click="modelPagination.currentPage=modelPagination.totalItems;changePage(modelPagination.totalItems)">末页</a>
    </pagination>
  </div>
</md-content>
<!-- 活动列表 end
